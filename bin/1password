#!/usr/bin/env python3
#pylint: disable=invalid-name

"""
Author: Sean Richardson
Email : richasea<at>gmail.com
Description: Allows command line access to 1password files.
"""

import configparser
import os
import sys

def main():
    """
    The main method of the script.
    """
    home_dir = os.getenv("HOME")
    config_name = ".1password"
    config_path = os.path.join(home_dir, config_name)

    if not os.path.exists(config_path):
        print("Missing config ~/.1password", file=sys.stderr)
        sys.exit(1)

    config = configparser.ConfigParser()
    config.read([config_path])

    if not config.has_option("", "vault"):
        print("Invalid configuration")
        sys.exit(1)

    vault = config.get("DEFAULT", "vault")
    if not os.path.isdir(vault):
        print("Invalid configuration: {vault} not found".format(vault=vault))
        sys.exit(1)

if __name__ == "__main__":
    main()

# vim: et ai ts=4
